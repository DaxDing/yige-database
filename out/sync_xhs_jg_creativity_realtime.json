{
    "type": "job",
    "version": "2.0",
    "steps": [
        {
            "stepType": "restapi",
            "parameter": {
                "customHeader": {
                    "Access-Token": "${Access-Token}",
                    "Content-Type": "application/json"
                },
                "dirtyData": "dirty",
                "method": "POST",
                "defaultHeader": {},
                "column": [
                    {
                        "name": ".",
                        "type": "string"
                    },
                    {
                        "name": "time",
                        "type": "string"
                    }
                ],
                "requestParam": "page_num",
                "url": "https://adapi.xiaohongshu.com/api/open/jg/data/report/realtime/creativity",
                "breakDataPathEmpty": true,
                "dataPath": "creativity_dtos",
                "dataMode": "multiData",
                "responseType": "json",
                "startIndex": 1,
                "endIndex": 1000,
                "datasource": "xhs_jg_report_realtime_creativity_v1",
                "requestTimes": "multiple",
                "step": 1,
                "parameters": "{\n  \"advertiser_id\": ${dag.foreach.current},\n  \"start_date\": \"${start_date}\",\n  \"end_date\": \"${end_date}\",\n  \"page_num\": 1,\n  \"page_size\": 100,\n  \"need_hourly_data\": true\n}"
            },
            "name": "Reader",
            "category": "reader"
        },
        {
            "stepType": "odps",
            "parameter": {
                "partition": "ds=${bizdate}",
                "truncate": false,
                "datasource": "default_datasource_cn_hangzhou_530486",
                "tunnelQuota": "default",
                "column": [
                    "raw_data",
                    "dt"
                ],
                "emptyAsNull": false,
                "table": "ods_xhs_jg_creativity_realtime_hi",
                "consistencyCommit": false
            },
            "name": "Writer",
            "category": "writer"
        }
    ],
    "setting": {
        "common": {
            "column": {
                "timeZone": "Asia/Shanghai"
            }
        },
        "errorLimit": {
            "record": ""
        },
        "locale": "zh_CN",
        "speed": {
            "throttle": false,
            "concurrent": 4
        }
    },
    "order": {
        "hops": [
            {
                "from": "Reader",
                "to": "Writer"
            }
        ]
    }
}
