# CSV vs DWD 创意层比对报告

> 比对对象: 聚光平台导出 CSV vs `dwd_xhs_creative_hi`
> 比对日期: 2026-01-26 / 2026-01-27
> ETL: `etl_xhs_creative_hi.sql` (ODS → DWD)

---

## 1. 数据概况

| 维度       | 26 日 CSV        | 26 日 DWD    | 27 日 CSV        | 27 日 DWD    |
| ---------- | ---------------- | ------------ | ---------------- | ------------ |
| 行数       | 857 (含定向拆分) | 236 (创意级) | 687 (含定向拆分) | 186 (创意级) |
| 创意 ID 数 | 21               | 21           | 20               | 20           |
| 时段数     | 23               | 24           | 13               | 19           |

- CSV 粒度：创意 × 精准定向 × 小时（多行对应 DWD 一行）
- DWD 粒度：创意 × 小时

---

## 2. 聚合总量比对

DWD 已按 CSV 同一批 creativity_id 过滤，确保比对范围一致。

### 26 日 (ds=20260126)

| 指标        | CSV      | DWD      | 差异  | 差异%  |
| ----------- | -------- | -------- | ----- | ------ |
| fee         | 4,507.75 | 4,511.54 | +3.79 | +0.08% |
| impression  | 81,813   | 81,871   | +58   | +0.07% |
| click       | 8,756    | 8,761    | +5    | +0.06% |
| like        | 16       | 16       | 0     | 0%     |
| comment     | 0        | 0 (NULL) | 0     | 0%     |
| collect     | 3        | 3        | 0     | 0%     |
| follow      | 1        | 1        | 0     | 0%     |
| share       | 3        | 3        | 0     | 0%œ   |
| interaction | 23       | 23       | 0     | 0%     |

### 27 日 (ds=20260127)

| 指标        | CSV      | DWD      | 差异  | 差异%  |
| ----------- | -------- | -------- | ----- | ------ |
| fee         | 4,454.48 | 4,455.92 | +1.44 | +0.03% |
| impression  | 83,111   | 83,145   | +34   | +0.04% |
| click       | 8,756    | 8,758    | +2    | +0.02% |
| like        | 19       | 19       | 0     | 0%     |
| comment     | 3        | 3        | 0     | 0%     |
| collect     | 10       | 10       | 0     | 0%     |
| follow      | 2        | 2        | 0     | 0%     |
| share       | 5        | 5        | 0     | 0%     |
| interaction | 39       | 39       | 0     | 0%     |

---

## 3. 差异归因

### 26 日

DWD 有 24 个时段，CSV 缺少 `04:00-04:59` (1 个时段)。差异全部来源于：

- CSV 缺失时段的低量数据
- 同一时段内 CSV 精准定向行之和 < DWD 创意级总量（部分定向行未导出）

### 27 日

DWD 有 19 个时段，CSV 仅 13 个。CSV 缺少 `00:00, 02:00, 07:00, 08:00, 09:00, 11:00` 共 6 个时段。

| 差异来源       | fee             | impression    | click        |
| -------------- | --------------- | ------------- | ------------ |
| DWD 多出时段   | +0.57           | +16           | +1           |
| 共有时段残差   | +0.87           | +18           | +1           |
| **合计** | **+1.44** | **+34** | **+2** |

共有时段残差集中在 `13:00` (DWD fee=635.92 vs CSV=635.05)，原因同上：CSV 定向行不完整。

---

## 4. 单创意逐字段抽查

### 26 日: CID=3405618471 @ 14:00-14:59

| 字段             | CSV (聚合) | DWD      | 一致 |
| ---------------- | ---------- | -------- | ---- |
| fee              | 10.69      | 10.69    | ✅   |
| impression       | 133        | 133      | ✅   |
| click            | 14         | 14       | ✅   |
| like             | 0          | NULL     | ✅   |
| comment          | 0          | NULL     | ✅   |
| collect          | 0          | NULL     | ✅   |
| follow           | 0          | NULL     | ✅   |
| share            | 0          | NULL     | ✅   |
| interaction      | 0          | NULL     | ✅   |
| search_cmt_click | 4          | 4 (JSON) | ✅   |

### 27 日: CID=3405618471 @ 14:00-14:59

| 字段        | CSV (3 行聚合) | DWD  | 一致 |
| ----------- | -------------- | ---- | ---- |
| fee         | 7.78           | 7.78 | ✅   |
| impression  | 90             | 90   | ✅   |
| click       | 11             | 11   | ✅   |
| like        | 0              | NULL | ✅   |
| comment     | 0              | NULL | ✅   |
| collect     | 0              | NULL | ✅   |
| follow      | 0              | NULL | ✅   |
| share       | 0              | NULL | ✅   |
| interaction | 0              | NULL | ✅   |

> NULL vs 0：API 仅返回非零字段，DWD 保留 NULL 语义，CSV 显示 0。两者等价。

---

## 5. 结论

| 项目           | 26 日                          | 27 日                          |
| -------------- | ------------------------------ | ------------------------------ |
| 最大差异%      | 0.08% (fee)                    | 0.04% (impression)             |
| 互动指标       | 完全一致                       | 完全一致                       |
| 单创意精确匹配 | ✅                             | ✅                             |
| 差异原因       | CSV 缺 1 个时段 + 定向行不完整 | CSV 缺 6 个时段 + 定向行不完整 |

**DWD 数据准确可靠。** 所有差异均可归因于 CSV 导出机制（低量时段未导出 + 精准定向拆分行不完整），DWD 作为 API 创意级别完整数据，数值 ≥ CSV 是预期行为。
